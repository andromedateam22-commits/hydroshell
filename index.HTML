html
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HYDROSHELL IRAQ - NASA Artemis Lunar Base Simulator</title>
    
    <!-- Ù…ÙƒØªØ¨Ø§Øª Three.js -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/PointerLockControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/TextureLoader.js"></script>
    
    <style>
        /* ========== Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø· ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            user-select: none;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Tajawal', 'Orbitron', sans-serif;
            background: #000;
            color: white;
            touch-action: none;
        }
        
        /* ========== Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ========== */
        .screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #000;
            z-index: 1000;
            transition: opacity 1s ease;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
        .start-screen {
            background: url('https://images-assets.nasa.gov/image/iss043e102807/iss043e102807~large.jpg') center/cover no-repeat;
        }
        
        .start-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(3px);
        }
        
        .start-content {
            position: relative;
            z-index: 2;
            text-align: center;
            padding: 2rem;
            max-width: 800px;
            background: rgba(0, 10, 20, 0.8);
            border-radius: 15px;
            border: 1px solid rgba(0, 243, 255, 0.3);
            box-shadow: 0 0 40px rgba(0, 243, 255, 0.2);
        }
        
        .main-logo {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(2.5rem, 6vw, 4.5rem);
            font-weight: bold;
            background: linear-gradient(45deg, #00a8cc, #0097e6);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 20px rgba(0, 168, 204, 0.5);
            letter-spacing: 1px;
        }
        
        .subtitle {
            font-size: clamp(1rem, 2.5vw, 1.5rem);
            color: #7fffd4;
            margin-bottom: 2rem;
            font-weight: 300;
        }
        
        .nasa-badge {
            display: inline-block;
            background: #e31837;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            font-weight: bold;
            letter-spacing: 1px;
        }
        
        .start-button {
            padding: 1.2rem 3rem;
            font-size: 1.3rem;
            background: linear-gradient(45deg, #006080, #00a0cc);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Orbitron', sans-serif;
            margin: 1.5rem 0;
            position: relative;
            overflow: hidden;
            letter-spacing: 1px;
        }
        
        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 243, 255, 0.4);
        }
        
        .mission-info {
            color: #aaa;
            font-size: 0.9rem;
            margin-top: 1rem;
            line-height: 1.5;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ø®ØµÙŠØ© */
        .character-select-screen {
            background: url('https://images-assets.nasa.gov/image/ksc-20210520-ph-mhm02_0044/ksc-20210520-ph-mhm02_0044~large.jpg') center/cover no-repeat;
        }
        
        .character-select-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
        }
        
        .character-title {
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            color: #00f3ff;
            margin-bottom: 2rem;
            text-align: center;
            position: relative;
            z-index: 2;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }
        
        .characters-container {
            position: relative;
            z-index: 2;
            max-width: 1200px;
            width: 90%;
            max-height: 70vh;
            overflow-y: auto;
            background: rgba(0, 15, 30, 0.9);
            border-radius: 12px;
            border: 1px solid rgba(0, 243, 255, 0.2);
            padding: 2rem;
        }
        
        .characters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .character-card {
            background: linear-gradient(145deg, rgba(10, 25, 47, 0.9), rgba(5, 15, 30, 0.9));
            border: 1px solid rgba(0, 243, 255, 0.15);
            border-radius: 10px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .character-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 243, 255, 0.1), transparent);
            transition: left 0.7s;
        }
        
        .character-card:hover::before {
            left: 100%;
        }
        
        .character-card:hover {
            border-color: #00f3ff;
            box-shadow: 0 5px 20px rgba(0, 243, 255, 0.2);
            transform: translateY(-5px);
        }
        
        .character-card.selected {
            background: linear-gradient(145deg, rgba(0, 60, 120, 0.7), rgba(0, 40, 80, 0.7));
            border-color: #00ff00;
            box-shadow: 0 0 25px rgba(0, 255, 0, 0.3);
        }
        
        .character-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0097e6, #00a8cc);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin: 0 auto 1rem;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .character-info {
            text-align: center;
        }
        
        .character-name {
            font-size: 1.2rem;
            color: #00f3ff;
            margin-bottom: 0.4rem;
            font-weight: 500;
        }
        
        .character-role {
            color: #ffcc00;
            font-size: 0.9rem;
            margin-bottom: 0.4rem;
            font-weight: 400;
        }
        
        .character-nationality {
            color: #7fffd4;
            font-size: 0.85rem;
            font-weight: 300;
        }
        
        .confirm-button {
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
            background: linear-gradient(45deg, #00a67c, #00cc95);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Orbitron', sans-serif;
            display: block;
            margin: 0 auto;
        }
        
        .confirm-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 255, 170, 0.3);
        }
        
        .confirm-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
        .game-screen {
            display: none;
        }
        
        #gameCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        

        /* Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ø¬ÙˆØ§Ù„ */
        .mobile-controls {
            position: fixed;
            bottom: 30px;
            left: 0;
            width: 100%;
            display: none;
            justify-content: space-between;
            padding: 0 30px;
            z-index: 10;
            pointer-events: none;
        }
        
        .mobile-joystick {
            width: 100px;
            height: 100px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.2);
            position: relative;
            pointer-events: auto;
            touch-action: none;
        }
        
        .joystick-head {
            position: absolute;
            width: 40px;
            height: 40px;
            background: rgba(0, 243, 255, 0.7);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: transform 0.1s;
        }
        
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            pointer-events: auto;
        }
        
        .action-btn {
            width: 50px;
            height: 50px;
            background: rgba(0, 100, 255, 0.8);
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            touch-action: manipulation;
        }
        
        .action-btn:active {
            transform: scale(0.9);
            background: rgba(0, 100, 255, 1);
        }
        
        /* HUD */
        .hud {
            position: fixed;
            top: 20px;
            left: 20px;
            right: 20px;
            z-index: 10;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
        }
        
        .hud-left, .hud-right {
            background: rgba(0, 0, 0, 0.6);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(0, 243, 255, 0.2);
            backdrop-filter: blur(5px);
            min-width: 180px;
            font-size: 0.9rem;
        }
        
        .hud-item {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .hud-item:last-child {
            margin-bottom: 0;
        }
        
        .hud-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }
        
        .interaction-hint {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: #00ff00;
            padding: 10px 20px;
            border-radius: 6px;
            border: 1px solid #00ff00;
            font-size: 1rem;
            display: none;
            z-index: 10;
            pointer-events: none;
            backdrop-filter: blur(5px);
            text-align: center;
            min-width: 200px;
        }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .loading-bar-container {
            width: 300px;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 20px;
        }
        
        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, #006080, #00a0cc);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .loading-text {
            color: #7fffd4;
            margin-top: 15px;
            font-size: 0.9rem;
        }
        
        /* Ø²Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø© */
        .language-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
        }
        
        .lang-btn {
            padding: 8px 16px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: 1px solid #00f3ff;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
        }
        
        .lang-btn:hover {
            background: rgba(0, 243, 255, 0.2);
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ù†ÙˆÙ… */
        .sleep-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 1000;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .sleep-text {
            font-size: clamp(1.8rem, 4vw, 3.5rem);
            color: #7fffd4;
            text-align: center;
            animation: breathe 3s infinite ease-in-out;
        }
        
        @keyframes breathe {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        /* Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª */
        .instructions {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.6);
            color: #aaa;
            padding: 10px;
            border-radius: 6px;
            font-size: 0.8rem;
            z-index: 9;
            pointer-events: none;
            max-width: 300px;
        }
        
        /* ========== ÙˆØ³Ø§Ø¦Ø· Ù…ØªØ¹Ø¯Ø¯Ø© ========== */
        @media (max-width: 768px) {
            .hud {
                flex-direction: column;
                gap: 10px;
                top: 10px;
                left: 10px;
                right: 10px;
            }
            
            .hud-left, .hud-right {
                width: 100%;
                min-width: auto;
                padding: 10px;
                font-size: 0.8rem;
            }
            
            .mobile-controls {
                display: flex;
            }
            
            .character-card {
                padding: 1rem;
            }
            
            .character-avatar {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
            
            .character-name {
                font-size: 1rem;
            }
            
            .interaction-hint {
                bottom: 150px;
                font-size: 0.9rem;
                padding: 8px 16px;
            }
            
            .instructions {
                display: none;
            }
        }
        
        @media (min-width: 769px) {
            .mobile-controls {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Ø²Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø© -->
    <div class="language-switcher">
        <button class="lang-btn" id="langBtn">EN</button>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
    <div class="screen start-screen" id="startScreen">
        <div class="start-content">
            <div class="main-logo" id="mainLogo">HYDROSHELL IRAQ</div>
            <div class="nasa-badge">NASA ARTEMIS PROGRAM</div>
            <div class="subtitle" id="subtitle">Ù…Ø­Ø§ÙƒØ§Ø© ÙˆØ§Ù‚Ø¹ÙŠØ© Ù„Ù…Ø­Ø·Ø© Artemis Ø§Ù„Ù‚Ù…Ø±ÙŠØ© Ø¨Ù†Ø³Ø¨ Ù†Ø§Ø³Ø§</div>
            <button class="start-button" id="startButton">ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ù‡Ù…Ø©</button>
            <div class="mission-info">
                <div>Ø§Ù„Ù…Ø³ØªÙˆÙ‰: Ù…Ø­Ø§ÙƒØ§Ø© Ù…ØªÙ‚Ø¯Ù…Ø© | Ù†Ø³Ø¨Ø© Ø§Ù„Ø¯Ù‚Ø©: 1:1 Ù…Ø¹ Ù…Ù‚Ø§ÙŠÙŠØ³ Ù†Ø§Ø³Ø§</div>
                <div>Ø§Ù„ØªØ­ÙƒÙ…: WASD Ù„Ù„Ø­Ø±ÙƒØ© | E Ù„Ù„ØªÙØ§Ø¹Ù„ | Ø§Ù„ÙØ£Ø±Ø© Ù„Ù„Ø±Ø¤ÙŠØ©</div>
            </div>
        </div>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ø®ØµÙŠØ© -->
    <div class="screen character-select-screen" id="characterScreen" style="display: none;">
        <h2 class="character-title" id="characterTitle">Ø§Ø®ØªØ± Ø±Ø§Ø¦Ø¯ Ø§Ù„ÙØ¶Ø§Ø¡</h2>
        
        <div class="characters-container">
            <div class="characters-grid" id="charactersGrid">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
            </div>
            
            <button class="confirm-button" id="confirmButton" disabled>âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±</button>
            
            <div style="margin-top: 1rem; color: #7fffd4; font-size: 0.9rem; text-align: center;">
                <span id="selectedCount">0</span> Ø´Ø®ØµÙŠØ© Ù…Ø®ØªØ§Ø±Ø©
            </div>
        </div>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© -->
    <div class="game-screen" id="gameScreen">
        <canvas id="gameCanvas"></canvas>
        
        <!-- HUD -->
        <div class="hud">
            <div class="hud-left">
                <div class="hud-item" id="hudCharacter">
                    <span class="hud-icon">ğŸ‘¨â€ğŸš€</span>
                    <span id="characterName">-</span>
                </div>
                <div class="hud-item" id="hudLocation">
                    <span class="hud-icon">ğŸ“</span>
                    <span id="locationText">Ù…Ø­Ø·Ø© Artemis Ø§Ù„Ù‚Ù…Ø±ÙŠØ©</span>
                </div>
                <div class="hud-item" id="hudObjective">
                    <span class="hud-icon">ğŸ¯</span>
                    <span id="objectiveText">Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ù…Ø­Ø·Ø©</span>
                </div>
            </div>
            <div class="hud-right">
                <div class="hud-item" id="hudOxygen">
                    <span class="hud-icon">ğŸ’¨</span>
                    <span>Oâ‚‚: <span id="oxygenValue">100</span>%</span>
                </div>
                <div class="hud-item" id="hudPressure">
                    <span class="hud-icon">ğŸ“Š</span>
                    <span>Pressure: <span id="pressureValue">14.7</span> psi</span>
                </div>
                <div class="hud-item" id="hudTemperature">
                    <span class="hud-icon">ğŸŒ¡ï¸</span>
                    <span>Temp: <span id="tempValue">22</span>Â°C</span>
                </div>
            </div>
        </div>
        
        <!-- ØªÙ„Ù…ÙŠØ­Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ -->
        <div class="interaction-hint" id="interactionHint"></div>
        
        <!-- ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="instructions" id="desktopInstructions">
            ØªØ­ÙƒÙ…: WASD Ù„Ù„Ø­Ø±ÙƒØ© | E Ù„Ù„ØªÙØ§Ø¹Ù„ | Ù…Ø³Ø§ÙØ© Ù„Ù„Ù‚ÙØ² | Shift Ù„Ù„Ø±ÙƒØ¶
        </div>
        
        <!-- ØªØ­ÙƒÙ… Ø§Ù„Ø¬ÙˆØ§Ù„ -->
        <div class="mobile-controls">
            <div class="mobile-joystick" id="joystick">
                <div class="joystick-head"></div>
            </div>
            <div class="action-buttons">
                <button class="action-btn" id="actionBtn">E</button>
                <button class="action-btn" id="jumpBtn">â†‘</button>
            </div>
        </div>
    </div>


    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù†ÙˆÙ… -->
    <div class="sleep-overlay" id="sleepScreen">
        <div class="sleep-text" id="sleepText">ğŸ’¤ Ø§Ù„Ù…Ø­Ø·Ø© ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ø³Ø¨Ø§Øª</div>
        <div class="sleep-text" style="font-size: 1.2rem; margin-top: 1rem;">Ø§Ù„Ù…Ù‡Ù…Ø© Ø§ÙƒØªÙ…Ù„Øª Ø¨Ù†Ø¬Ø§Ø­!</div>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div class="loading-container" id="loadingScreen" style="display: none;">
        <div style="text-align: center;">
            <div style="font-size: 2rem; color: #00f3ff; margin-bottom: 1rem;">ğŸš€</div>
            <div style="color: #7fffd4; font-size: 1.2rem; margin-bottom: 0.5rem;" id="loadingTitle">ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©</div>
            <div class="loading-bar-container">
                <div class="loading-bar" id="loadingBar"></div>
            </div>
            <div class="loading-text" id="loadingText">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯...</div>
        </div>
    </div>

    <!-- Ù…Ø®ÙÙŠ Ù„Ù„ØµÙˆØª -->
    <audio id="bgMusic" loop>
        <source src="https://assets.mixkit.co/music/preview/mixkit-space-game-668.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="clickSound">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="walkSound">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-footsteps-on-metal-floor-892.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="doorSound">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-sliding-door-389.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="machineSound">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-sci-fi-machine-working-800.mp3" type="audio/mpeg">
    </audio>

    <script>
        // ========== Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ - Ù…Ø­Ø§ÙƒØ§Ø© ÙˆØ§Ù‚Ø¹ÙŠØ© Ø¨Ù†Ø³Ø¨ Ù†Ø§Ø³Ø§ ==========
        class ArtemisMission {
            constructor() {
                // Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
                this.state = {
                    language: 'ar',
                    selectedCharacter: null,
                    gameLoaded: false,
                    currentLocation: 'artemis_base_exterior',
                    currentObjective: 'explore_base',
                    oxygen: 100,
                    pressure: 14.7,
                    temperature: 22,
                    missionTime: 0,
                    interactions: 0,
                    systemStatus: 'NOMINAL',
                    progress: this.loadProgress() || {}
                };
                
// Ø±ÙˆØ§Ø¯ Ø§Ù„ÙØ¶Ø§Ø¡ (Ù†Ø§Ø³Ø§ Ø³ØªØ§ÙŠÙ„)
this.astronauts = [
    { 
        id: 1, 
        name: { ar: 'Ø§Ù„Ù‚Ø§Ø¦Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¥ÙŠØ§Ø¯', en: 'Commander Abdullah Iyad' },
        role: { ar: 'Ù‚Ø§Ø¦Ø¯ Ø§Ù„Ù…Ù‡Ù…Ø©', en: 'Mission Commander' },
        nationality: { ar: 'Ø§Ù„Ø¹Ø±Ø§Ù‚', en: 'Iraq' },
        avatar: 'ğŸ‘¨â€ğŸš€',
        experience: '15 Ø³Ù†Ø© ÙÙŠ Ø§Ù„Ù…Ù„Ø§Ø­Ø© Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ©',
        specialty: 'Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø©'
    },
    { 
        id: 2, 
        name: { ar: 'Ø§Ù„Ù‚Ø§Ø¦Ø¯ ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ† Ø¹Ø§Ù…Ø±', en: 'Commander Salahuddin Amer' },
        role: { ar: 'Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù‚Ø§Ø¦Ø¯', en: 'Assistant Commander' },
        nationality: { ar: 'Ø§Ù„Ø¹Ø±Ø§Ù‚', en: 'Iraq' },
        avatar: 'ğŸ§‘â€ğŸš€',
        experience: '12 Ø³Ù†Ø© ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ©',
        specialty: 'Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ ÙˆØ§Ù„Ø¯Ø¹Ù…'
    },
    { 
        id: 3, 
        name: { ar: 'Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø¹Ù„ÙŠ Ø§Ù„Ø£ÙƒØ¨Ø±', en: 'Engineer Ali Al-Akbar' },
        role: { ar: 'Ù…Ù‡Ù†Ø¯Ø³ Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª', en: 'Communications Engineer' },
        nationality: { ar: 'Ù„Ø¨Ù†Ø§Ù†', en: 'Lebanon' },
        avatar: 'ğŸ“¡',
        experience: '14 Ø³Ù†Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ©',
        specialty: 'Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª'
    },
    { 
        id: 4, 
        name: { ar: 'Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ù…Ù†ØªØ¸Ø± Ø¹Ù„ÙŠ', en: 'Engineer Muntadhar Ali' },
        role: { ar: 'Ù…Ù‡Ù†Ø¯Ø³ Ø­Ø§Ø³ÙˆØ¨', en: 'Computer Engineer' },
        nationality: { ar: 'Ø§Ù„Ø¹Ø±Ø§Ù‚', en: 'Iraq' },
        avatar: 'ğŸ‘¨â€ğŸ’»',
        experience: '10 Ø³Ù†Ø© ÙÙŠ Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ø£Ù†Ø¸Ù…Ø©',
        specialty: 'Ø¨Ø±Ù…Ø¬Ø© ÙˆØ£Ù†Ø¸Ù…Ø© Ø§Ù„ØªØ­ÙƒÙ…'
    },
    { 
        id: 5, 
        name: { ar: 'Ø±Ø§Ø¦Ø¯ Ø§Ù„ÙØ¶Ø§Ø¡ Ø¹Ù„ÙŠ Ø³Ø±Ø­Ø§Ù†', en: 'Astronaut Ali Sarhan' },
        role: { ar: 'Ø±Ø§Ø¦Ø¯ Ø§Ù„ÙØ¶Ø§Ø¡', en: 'Astronaut' },
        nationality: { ar: 'Ø§Ù„Ø¹Ø±Ø§Ù‚', en: 'Iraq' },
        avatar: 'ğŸš€',
        experience: '8 Ø³Ù†ÙˆØ§Øª ÙÙŠ Ø§Ù„Ø±Ø­Ù„Ø§Øª Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ©',
        specialty: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©'
    },
    { 
        id: 6, 
        name: { ar: 'Ø±Ø§Ø¦Ø¯ Ø§Ù„ÙØ¶Ø§Ø¡ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø·Ø§Ø¦ÙŠ', en: 'Astronaut Mohammed Al-Tai' },
        role: { ar: 'Ø±Ø§Ø¦Ø¯ ÙØ¶Ø§Ø¡ Ø±ØªØ¨Ø© Ù¢', en: 'Astronaut Rank 2' },
        nationality: { ar: 'Ø§Ù„Ø¹Ø±Ø§Ù‚', en: 'Iraq' },
        avatar: 'ğŸ‘¨â€ğŸš€',
        experience: '6 Ø³Ù†ÙˆØ§Øª ÙÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ¨Ø§Øª Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ©',
        specialty: 'Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©'
    },
    { 
        id: 7, 
        name: { ar: 'Ø§Ù„Ø¹Ø§Ù„Ù…Ø© Ø²Ù‡Ø±Ø§Ø¡ Ø¹Ù„ÙŠ', en: 'Scientist Zahra Ali' },
        role: { ar: 'Ø¹Ø§Ù„Ù…Ø© Ø­Ø§Ø³ÙˆØ¨', en: 'Computer Scientist' },
        nationality: { ar: 'Ø§Ù„Ø¹Ø±Ø§Ù‚', en: 'Iraq' },
        avatar: 'ğŸ‘©â€ğŸ”¬',
        experience: '12 Ø³Ù†Ø© ÙÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ',
        specialty: 'Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'
    },
    { 
        id: 8, 
        name: { ar: 'Ø±Ø§Ø¦Ø¯Ø© Ø§Ù„ÙØ¶Ø§Ø¡ Ø¯Ø¹Ø§Ø¡ Ø±Ø§Ø´Ø¯', en: 'Astronaut Duaa Rashid' },
        role: { ar: 'Ø±Ø§Ø¦Ø¯Ø© ÙØ¶Ø§Ø¡', en: 'Astronaut' },
        nationality: { ar: 'Ø§Ù„ÙŠÙ…Ù†', en: 'Yemen' },
        avatar: 'ğŸ‘©â€ğŸš€',
        experience: '9 Ø³Ù†ÙˆØ§Øª ÙÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ¨Ø§Øª Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ©',
        specialty: 'Ø§Ù„Ø£Ø¨Ø­Ø§Ø« ÙˆØ§Ù„ØªØ¬Ø§Ø±Ø¨'
    },
    { 
        id: 9, 
        name: { ar: 'Ø±Ø§Ø¦Ø¯Ø© Ø§Ù„ÙØ¶Ø§Ø¡ Ù…Ø±ÙŠÙ… Ù„ÙØªÙ‡', en: 'Astronaut Maryam Lufta' },
        role: { ar: 'Ø±Ø§Ø¦Ø¯Ø© ÙØ¶Ø§Ø¡ Ù¡', en: 'Astronaut 1' },
        nationality: { ar: 'Ø§Ù„Ø¹Ø±Ø§Ù‚', en: 'Iraq' },
        avatar: 'ğŸ‘©â€ğŸš€',
        experience: '11 Ø³Ù†Ø© ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ©',
        specialty: 'Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© ÙˆØ§Ù„Ø¨Ø­Ø«'
    },
    { 
        id: 10, 
        name: { ar: 'Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³Ø© Ù‡Ù…Ø³Ø©', en: 'Engineer Hamsa' },
        role: { ar: 'Ù‡Ù†Ø¯Ø³Ø© Ù…ÙŠÙƒØ§ØªØ±ÙˆÙ†ÙƒØ³', en: 'Mechatronics Engineer' },
        nationality: { ar: 'Ø§Ù„Ø¹Ø±Ø§Ù‚', en: 'Iraq' },
        avatar: 'ğŸ‘©â€ğŸ”§',
        experience: '8 Ø³Ù†ÙˆØ§Øª ÙÙŠ Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ©',
        specialty: 'Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒØ§ ÙˆØ§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª'
    }
];
                // Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª
                this.translations = {
                    ar: {
                        title: "HYDROSHELL IRAQ",
                        subtitle: "Ù…Ø­Ø§ÙƒØ§Ø© ÙˆØ§Ù‚Ø¹ÙŠØ© Ù„Ù…Ø­Ø·Ø© Artemis Ø§Ù„Ù‚Ù…Ø±ÙŠØ© Ø¨Ù†Ø³Ø¨ Ù†Ø§Ø³Ø§",
                        startBtn: "ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ù‡Ù…Ø©",
                        selectTitle: "Ø§Ø®ØªØ± Ø±Ø§Ø¦Ø¯ Ø§Ù„ÙØ¶Ø§Ø¡",
                        confirmBtn: "âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±",
                        character: "Ø±Ø§Ø¦Ø¯ Ø§Ù„ÙØ¶Ø§Ø¡",
                        location: "Ø§Ù„Ù…ÙˆÙ‚Ø¹",
                        objective: "Ø§Ù„Ù‡Ø¯Ù",
                        exploreBase: "Ø§Ø³ØªÙƒØ´Ù Ù‚Ø§Ø¹Ø¯Ø© Artemis",
                        findRecycling: "Ø§Ø¨Ø­Ø« Ø¹Ù† ÙˆØ­Ø¯Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¯ÙˆÙŠØ±",
                        operateMachine: "Ø´ØºÙ„ Ø¢Ù„Ø© HYDROSHELL",
                        collectSample: "Ø§Ø¬Ù…Ø¹ Ø¹ÙŠÙ†Ø§Øª ØªØ±Ø¨Ø©",
                        returnToBase: "Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
                        missionComplete: "Ø§Ù„Ù…Ù‡Ù…Ø© Ø§ÙƒØªÙ…Ù„Øª",
                        langBtn: "EN",
                        selectedCount: "Ø±Ø§Ø¦Ø¯ ÙØ¶Ø§Ø¡ Ù…Ø®ØªØ§Ø±",
                        instructions: "ØªØ­ÙƒÙ…: WASD Ù„Ù„Ø­Ø±ÙƒØ© | E Ù„Ù„ØªÙØ§Ø¹Ù„ | Ù…Ø³Ø§ÙØ© Ù„Ù„Ù‚ÙØ²",
                        loadingModels: "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯...",
                        loadingTextures: "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ù…...",
                        loadingComplete: "Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ù†Ø·Ù„Ø§Ù‚!",
                        interactMachine: "Ø§Ø¶ØºØ· E Ù„ØªØ´ØºÙŠÙ„ Ø¢Ù„Ø© HYDROSHELL",
                        interactDoor: "Ø§Ø¶ØºØ· E Ù„ÙØªØ­ Ø§Ù„Ø¨Ø§Ø¨",
                        interactPanel: "Ø§Ø¶ØºØ· E Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…",
                        interactSample: "Ø§Ø¶ØºØ· E Ù„Ø¬Ù…Ø¹ Ø§Ù„Ø¹ÙŠÙ†Ø©"
                    },
                    en: {
                        title: "HYDROSHELL IRAQ",
                        subtitle: "NASA Artemis Lunar Base Realistic Simulator",
                        startBtn: "ğŸš€ Start Mission",
                        selectTitle: "Select Astronaut",
                        confirmBtn: "âœ… Confirm Selection",
                        character: "Astronaut",
                        location: "Location",
                        objective: "Objective",
                        exploreBase: "Explore Artemis Base",
                        findRecycling: "Find Recycling Module",
                        operateMachine: "Operate HYDROSHELL Machine",
                        collectSample: "Collect Soil Samples",
                        returnToBase: "Return to Main Module",
                        missionComplete: "Mission Complete",
                        langBtn: "AR",
                        selectedCount: "astronaut selected",
                        instructions: "Controls: WASD to move | E to interact | Space to jump",
                        loadingModels: "Loading 3D models...",
                        loadingTextures: "Loading textures...",
                        loadingComplete: "Ready for launch!",
                        interactMachine: "Press E to operate HYDROSHELL machine",
                        interactDoor: "Press E to open door",
                        interactPanel: "Press E to access control panel",
                        interactSample: "Press E to collect sample"
                    }
                };
                
                // Three.js Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
                this.scene = null;
                this.camera = null;
                this.renderer = null;
                this.controls = null;
                this.clock = null;
                this.objects = {};
                this.interactives = [];
                this.currentInteractive = null;
                
                // Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø±ÙƒØ©
                this.moveForward = false;
                this.moveBackward = false;
                this.moveLeft = false;
                this.moveRight = false;
                this.canJump = true;
                this.velocity = new THREE.Vector3();
                this.direction = new THREE.Vector3();
                
                // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ© (ÙˆØ§Ù‚Ø¹ÙŠØ© - Ù†Ø³Ø¨ Ù†Ø§Ø³Ø§)
                this.moveSpeed = 4.0; // 4 Ù…/Ø« - Ø³Ø±Ø¹Ø© ÙˆØ§Ù‚Ø¹ÙŠØ© ÙÙŠ Ø¨Ø¯Ù„Ø© ÙØ¶Ø§Ø¡
                this.jumpHeight = 7.0; // 7 Ù…/Ø« - Ù‚ÙˆØ© Ù‚ÙØ²Ø© Ù…Ù†Ø®ÙØ¶Ø© ÙÙŠ Ø§Ù„Ù‚Ù…Ø±
                this.gravity = 1.62; // Ø¬Ø§Ø°Ø¨ÙŠØ© Ø§Ù„Ù‚Ù…Ø±: 1.62 Ù…/Ø«Â²
                
                // Ø§Ù„ØµÙˆØª
                this.audio = {
                    bgMusic: document.getElementById('bgMusic'),
                    clickSound: document.getElementById('clickSound'),
                    walkSound: document.getElementById('walkSound'),
                    doorSound: document.getElementById('doorSound'),
                    machineSound: document.getElementById('machineSound'),
                    enabled: true
                };
                
                // Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ­ÙƒÙ…
                this.keys = {};
                
                // Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
                this.isMoving = false;
                this.isInteracting = false;
                this.missionStarted = false;
            }
            
            // ========== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… ==========
            async initialize() {
                console.log('ğŸš€ Artemis Mission Simulator - NASA Scale');
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯Ø¹Ù… WebGL
                if (!this.checkWebGLSupport()) {
                    this.showWebGLError();
                    return;
                }
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                this.setupUI();
                this.setupEventListeners();
                this.renderAstronauts();
                this.updateLanguage();
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØµÙˆØª
                this.setupAudio();
                
                console.log('âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙ‡ÙŠØ¦Ø©');
            }
            
            // ========== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† WebGL ==========
            checkWebGLSupport() {
                try {
                    const canvas = document.createElement('canvas');
                    return !!(window.WebGLRenderingContext && 
                        (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));
                } catch (e) {
                    return false;
                }
            }
            
            showWebGLError() {
                document.body.innerHTML = `
                    <div style="text-align: center; padding: 50px; color: white; background: #000;">
                        <h1 style="color: #ff3300;">âš ï¸ WebGL ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…</h1>
                        <p>ÙŠØ¬Ø¨ ØªÙØ¹ÙŠÙ„ WebGL ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØµÙØ­ Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©.</p>
                        <p>Chrome: chrome://flags â†’ ØªÙØ¹ÙŠÙ„ WebGL</p>
                        <p>Firefox: about:config â†’ webgl.force-enabled = true</p>
                        <button onclick="location.reload()" style="padding: 10px 20px; background: #ff3300; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 20px;">
                            Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
                        </button>
                    </div>
                `;
            }
            
            // ========== Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ==========
            setupUI() {
                this.updateUIText();
            }
            
            updateUIText() {
                const t = this.translations[this.state.language];
                
                document.getElementById('mainLogo').textContent = t.title;
                document.getElementById('subtitle').textContent = t.subtitle;
                document.getElementById('startButton').textContent = t.startBtn;
                document.getElementById('characterTitle').textContent = t.selectTitle;
                document.getElementById('confirmButton').textContent = t.confirmBtn;
                document.getElementById('langBtn').textContent = t.langBtn;
                document.getElementById('selectedCount').textContent = `0 ${t.selectedCount}`;
                document.getElementById('desktopInstructions').textContent = t.instructions;
            }
            
            // ========== Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ==========
            setupEventListeners() {
                // Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡
                document.getElementById('startButton').addEventListener('click', () => {
                    this.playSound('click');
                    this.showAstronautSelect();
                });
                
                // Ø²Ø± ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø´Ø®ØµÙŠØ©
                document.getElementById('confirmButton').addEventListener('click', () => {
                    if (this.state.selectedCharacter) {
                        this.playSound('click');
                        this.startMission();
                    }
                });
                
                // Ø²Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø©
                document.getElementById('langBtn').addEventListener('click', () => {
                    this.playSound('click');
                    this.toggleLanguage();
                });
                
                // ØªØ­ÙƒÙ… Ø§Ù„Ø¬ÙˆØ§Ù„
                this.setupMobileControls();
                
                // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„
                document.addEventListener('touchmove', (e) => {
                    if (e.target.id === 'joystick' || e.target.id === 'joystick-head') {
                        e.preventDefault();
                    }
                }, { passive: false });
            }
            

            // ========== Ø¥Ø¹Ø¯Ø§Ø¯ ØªØ­ÙƒÙ… Ø§Ù„Ø¬ÙˆØ§Ù„ ==========
            setupMobileControls() {
                const joystick = document.getElementById('joystick');
                const joystickHead = joystick.querySelector('.joystick-head');
                const actionBtn = document.getElementById('actionBtn');
                const jumpBtn = document.getElementById('jumpBtn');
                
                let touchId = null;
                
                joystick.addEventListener('touchstart', (e) => {
                    if (touchId === null && this.missionStarted) {
                        const touch = e.touches[0];
                        touchId = touch.identifier;
                        
                        const rect = joystick.getBoundingClientRect();
                        const centerX = rect.left + rect.width / 2;
                        const centerY = rect.top + rect.height / 2;
                        
                        this.mobileTouchStart = { x: centerX, y: centerY };
                        this.mobileTouchCurrent = { x: touch.clientX, y: touch.clientY };
                    }
                });
                
                joystick.addEventListener('touchmove', (e) => {
                    if (!this.missionStarted || touchId === null) return;
                    
                    for (let touch of e.touches) {
                        if (touch.identifier === touchId) {
                            this.mobileTouchCurrent = { x: touch.clientX, y: touch.clientY };
                            
                            const deltaX = touch.clientX - this.mobileTouchStart.x;
                            const deltaY = touch.clientY - this.mobileTouchStart.y;
                            
                            const distance = Math.min(40, Math.sqrt(deltaX * deltaX + deltaY * deltaY));
                            const angle = Math.atan2(deltaY, deltaX);
                            
                            const moveX = Math.cos(angle) * (distance / 40);
                            const moveY = Math.sin(angle) * (distance / 40);
                            
                            this.moveLeft = moveX < -0.3;
                            this.moveRight = moveX > 0.3;
                            this.moveForward = moveY < -0.3;
                            this.moveBackward = moveY > 0.3;
                            
                            joystickHead.style.transform = `translate(-50%, -50%) translate(${moveX * 30}px, ${moveY * 30}px)`;
                            break;
                        }
                    }
                });
                
                joystick.addEventListener('touchend', (e) => {
                    for (let touch of e.changedTouches) {
                        if (touch.identifier === touchId) {
                            this.moveLeft = false;
                            this.moveRight = false;
                            this.moveForward = false;
                            this.moveBackward = false;
                            joystickHead.style.transform = 'translate(-50%, -50%)';
                            touchId = null;
                            break;
                        }
                    }
                });
                
                actionBtn.addEventListener('touchstart', () => {
                    if (this.missionStarted) {
                        this.handleInteraction();
                        actionBtn.style.transform = 'scale(0.9)';
                    }
                });
                
                actionBtn.addEventListener('touchend', () => {
                    actionBtn.style.transform = 'scale(1)';
                });
                
                jumpBtn.addEventListener('touchstart', () => {
                    if (this.missionStarted && this.canJump) {
                        this.velocity.y += this.jumpHeight;
                        this.canJump = false;
                        jumpBtn.style.transform = 'scale(0.9)';
                    }
                });
                
                jumpBtn.addEventListener('touchend', () => {
                    jumpBtn.style.transform = 'scale(1)';
                });
            }
            
            // ========== Ø§Ø®ØªÙŠØ§Ø± Ø±Ø§Ø¦Ø¯ Ø§Ù„ÙØ¶Ø§Ø¡ ==========
            showAstronautSelect() {
                document.getElementById('startScreen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('startScreen').style.display = 'none';
                    document.getElementById('characterScreen').style.display = 'flex';
                    document.getElementById('characterScreen').style.opacity = '1';
                }, 1000);
            }
            
            renderAstronauts() {
                const grid = document.getElementById('charactersGrid');
                grid.innerHTML = '';
                
                this.astronauts.forEach(astro => {
                    const card = document.createElement('div');
                    card.className = 'character-card';
                    card.dataset.id = astro.id;
                    
                    const lang = this.state.language;
                    const name = astro.name[lang];
                    const role = astro.role[lang];
                    const nationality = astro.nationality[lang];
                    
                    card.innerHTML = `
                        <div class="character-avatar">${astro.avatar}</div>
                        <div class="character-info">
                            <div class="character-name">${name}</div>
                            <div class="character-role">${role}</div>
                            <div class="character-nationality">${nationality}</div>
                        </div>
                    `;
                    
                    card.addEventListener('click', () => {
                        this.selectAstronaut(astro.id);
                        
                        document.querySelectorAll('.character-card').forEach(c => {
                            c.classList.remove('selected');
                        });
                        card.classList.add('selected');
                    });
                    
                    grid.appendChild(card);
                });
            }
            
            selectAstronaut(id) {
                this.state.selectedCharacter = this.astronauts.find(a => a.id === id);
                document.getElementById('confirmButton').disabled = false;
                
                const t = this.translations[this.state.language];
                document.getElementById('selectedCount').textContent = `1 ${t.selectedCount}`;
                
                this.playSound('click');
            }
            
            // ========== Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ù‡Ù…Ø© ==========
            async startMission() {
                this.saveProgress();
                
                document.getElementById('characterScreen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('characterScreen').style.display = 'none';
                    document.getElementById('loadingScreen').style.display = 'flex';
                    
                    this.loadMission();
                }, 1000);
            }
            
            // ========== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø© ==========
            async loadMission() {
                this.updateLoading('ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…...', 10);
                
                try {
                    // ØªÙ‡ÙŠØ¦Ø© Three.js
                    await this.initThreeJS();
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    this.updateLoading('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ¦Ø© Ø§Ù„Ù‚Ù…Ø±...', 30);
                    await this.createLunarEnvironment();
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    this.updateLoading('Ø¬Ø§Ø±ÙŠ Ø¨Ù†Ø§Ø¡ Ù…Ø­Ø·Ø© Artemis...', 60);
                    await this.createArtemisBase();
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    this.updateLoading('Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©...', 80);
                    await this.setupMissionSystems();
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    this.updateLoading('Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ù†Ø·Ù„Ø§Ù‚!', 100);
                    
                    setTimeout(() => {
                        document.getElementById('loadingScreen').style.display = 'none';
                        document.getElementById('gameScreen').style.display = 'block';
                        this.missionStarted = true;
                        this.updateHUD();
                        this.setupKeyControls();
                        this.animate();
                        
                        // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¨Ø¯Ø¡
                        this.showNotification('Ø§Ù„Ù…Ù‡Ù…Ø© Artemis Ø¨Ø¯Ø£Øª - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ', 'info');
                    }, 1000);
                    
                } catch (error) {
                    console.error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©:', error);
                    this.showError('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.');
                }
            }
            
            updateLoading(text, percent) {
                document.getElementById('loadingTitle').textContent = text;
                document.getElementById('loadingBar').style.width = `${percent}%`;
                document.getElementById('loadingText').textContent = `${percent}% Ù…ÙƒØªÙ…Ù„`;
            }
            
            // ========== Three.js Ø§Ù„Ù†Ø¸Ø§Ù… ==========
            async initThreeJS() {
                // Ø§Ù„Ù…Ø´Ù‡Ø¯
                this.scene = new THREE.Scene();
                this.scene.fog = new THREE.Fog(0x000010, 100, 500);
                
                // Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
                this.camera = new THREE.PerspectiveCamera(
                    75,
                    window.innerWidth / window.innerHeight,
                    0.1,
                    1000
                );
                this.camera.position.set(0, 10, 20);
                this.camera.lookAt(0, 10, 0);
                
                // Ø§Ù„Ø¹Ø§Ø±Ø¶
                this.renderer = new THREE.WebGLRenderer({
                    canvas: document.getElementById('gameCanvas'),
                    antialias: true,
                    alpha: false
                });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                this.renderer.shadowMap.enabled = true;
                this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                this.renderer.outputEncoding = THREE.sRGBEncoding;
                
                // Ø§Ù„ØªØ­ÙƒÙ… (Ù†Ù…Ø· FPS ÙˆØ§Ù‚Ø¹ÙŠ)
                this.controls = new THREE.PointerLockControls(this.camera, document.body);
                
                // Ø§Ù„Ø³Ø§Ø¹Ø©
                this.clock = new THREE.Clock();
                
                // Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø©
                this.setupLighting();
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø¬Ù…
                window.addEventListener('resize', () => this.onWindowResize());
                
                console.log('âœ… Three.js Ù…Ù‡ÙŠØ£ - Ù†Ù…Ø· FPS ÙˆØ§Ù‚Ø¹ÙŠ');
            }
            
            setupLighting() {
                // Ø¶ÙˆØ¡ Ø§Ù„Ø´Ù…Ø³ (Ø§Ù„Ù‚Ù…Ø±)
                const sunLight = new THREE.DirectionalLight(0xffffff, 1.5);
                sunLight.position.set(100, 100, 50);
                sunLight.castShadow = true;
                sunLight.shadow.mapSize.width = 4096;
                sunLight.shadow.mapSize.height = 4096;
                sunLight.shadow.camera.near = 0.5;
                sunLight.shadow.camera.far = 500;
                sunLight.shadow.camera.left = -100;
                sunLight.shadow.camera.right = 100;
                sunLight.shadow.camera.top = 100;
                sunLight.shadow.camera.bottom = -100;
                this.scene.add(sunLight);
                
                // Ø¶ÙˆØ¡ ØªØ¹Ø¨Ø¦Ø© (Ø§Ù„ÙØ¶Ø§Ø¡)
                const ambientLight = new THREE.AmbientLight(0x404040, 0.3);
                this.scene.add(ambientLight);
                
                // Ø¶ÙˆØ¡ Ø£Ø±Ø¶ÙŠ (Ø§Ù„Ù‚Ù…Ø±)
                const moonLight = new THREE.HemisphereLight(0x444444, 0x111111, 0.1);
                this.scene.add(moonLight);
                
                // Ø¥Ø¶Ø§Ø¡Ø© Ù…Ø­ÙŠØ· Ø§Ù„Ù…Ø­Ø·Ø©
                const stationLight1 = new THREE.PointLight(0x00aaff, 0.5, 100);
                stationLight1.position.set(0, 30, 0);
                this.scene.add(stationLight1);
            }
            

            // ========== Ø¨Ù†Ø§Ø¡ Ø¨ÙŠØ¦Ø© Ø§Ù„Ù‚Ù…Ø± ==========
            async createLunarEnvironment() {
                // Ø§Ù„Ø£Ø±Ø¶ (Ø³Ø·Ø­ Ø§Ù„Ù‚Ù…Ø±)
                const moonRadius = 1000;
                const moonSegments = 128;
                
                // Ù‚ÙˆØ§Ù… Ø³Ø·Ø­ Ø§Ù„Ù‚Ù…Ø±
                const textureLoader = new THREE.TextureLoader();
                const moonTexture = textureLoader.load('https://images-assets.nasa.gov/image/PIA00405/PIA00405~small.jpg');
                moonTexture.wrapS = THREE.RepeatWrapping;
                moonTexture.wrapT = THREE.RepeatWrapping;
                moonTexture.repeat.set(20, 20);
                
                const moonGeometry = new THREE.SphereGeometry(moonRadius, moonSegments, moonSegments);
                const moonMaterial = new THREE.MeshStandardMaterial({
                    map: moonTexture,
                    roughness: 0.9,
                    metalness: 0.1,
                    bumpScale: 0.05
                });
                
                const moon = new THREE.Mesh(moonGeometry, moonMaterial);
                moon.rotation.x = Math.PI / 2;
                moon.position.y = -moonRadius + 2;
                moon.receiveShadow = true;
                this.scene.add(moon);
                this.objects.moon = moon;
                
                // Ø§Ù„Ù†Ø¬ÙˆÙ…
                const starGeometry = new THREE.BufferGeometry();
                const starCount = 10000;
                const starPositions = new Float32Array(starCount * 3);
                
                for (let i = 0; i < starCount * 3; i += 3) {
                    starPositions[i] = (Math.random() - 0.5) * 3000;
                    starPositions[i + 1] = (Math.random() - 0.5) * 3000;
                    starPositions[i + 2] = (Math.random() - 0.5) * 3000;
                }
                
                starGeometry.setAttribute('position', new THREE.BufferAttribute(starPositions, 3));
                
                const starMaterial = new THREE.PointsMaterial({
                    color: 0xffffff,
                    size: 1.5,
                    sizeAttenuation: true,
                    transparent: true
                });
                
                const stars = new THREE.Points(starGeometry, starMaterial);
                this.scene.add(stars);
                
                // Ø§Ù„Ø£Ø±Ø¶ ÙÙŠ Ø§Ù„Ø³Ù…Ø§Ø¡ (Ù„Ù„Ø®Ù„ÙÙŠØ©)
                const earthGeometry = new THREE.SphereGeometry(20, 32, 32);
                const earthTexture = textureLoader.load('https://images-assets.nasa.gov/image/GSFC_20171208_Archive_e001589/GSFC_20171208_Archive_e001589~small.jpg');
                const earthMaterial = new THREE.MeshBasicMaterial({
                    map: earthTexture,
                    transparent: true,
                    opacity: 0.8
                });
                
                const earth = new THREE.Mesh(earthGeometry, earthMaterial);
                earth.position.set(100, 80, -200);
                this.scene.add(earth);
                this.objects.earth = earth;
                
                console.log('âœ… Ø¨ÙŠØ¦Ø© Ø§Ù„Ù‚Ù…Ø± Ø¬Ø§Ù‡Ø²Ø©');
            }
            
            // ========== Ø¨Ù†Ø§Ø¡ Ù…Ø­Ø·Ø© Artemis (ÙˆØ§Ù‚Ø¹ÙŠØ©) ==========
            async createArtemisBase() {
                // Ø§Ù„Ø£Ø±Ø¶ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Ù…Ù†ØµØ© Ø§Ù„Ù‡Ø¨ÙˆØ·)
                const landingPadGeometry = new THREE.CylinderGeometry(50, 50, 1, 32);
                const landingPadMaterial = new THREE.MeshStandardMaterial({
                    color: 0x333333,
                    metalness: 0.8,
                    roughness: 0.3
                });
                
                const landingPad = new THREE.Mesh(landingPadGeometry, landingPadMaterial);
                landingPad.position.set(0, 0.5, 0);
                landingPad.receiveShadow = true;
                this.scene.add(landingPad);
                this.objects.landingPad = landingPad;
                
                // === Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Habitat Module) - Ø­Ø¬Ù… ÙˆØ§Ù‚Ø¹ÙŠ 8Ã—12Ù… ===
                const mainModuleGroup = new THREE.Group();
                
                // Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø´ÙƒÙ„ Ø£Ø³Ø·ÙˆØ§Ù†ÙŠ - Ù…Ø«Ù„ ÙˆØ­Ø¯Ø§Øª Ù†Ø§Ø³Ø§ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)
                const mainModuleGeometry = new THREE.CylinderGeometry(4, 4, 12, 16);
                const mainModuleMaterial = new THREE.MeshStandardMaterial({
                    color: 0xffffff,
                    metalness: 0.7,
                    roughness: 0.2,
                    envMapIntensity: 0.5
                });
                
                const mainModule = new THREE.Mesh(mainModuleGeometry, mainModuleMaterial);
                mainModule.position.set(0, 6, 0);
                mainModule.castShadow = true;
                mainModule.receiveShadow = true;
                mainModuleGroup.add(mainModule);
                
                // Ø§Ù„Ù†ÙˆØ§ÙØ° (8 Ù†ÙˆØ§ÙØ° - Ù…ÙˆØ²Ø¹Ø© Ø¨Ø´ÙƒÙ„ ÙˆØ§Ù‚Ø¹ÙŠ)
                const windowGeometry = new THREE.PlaneGeometry(1, 0.8);
                const windowMaterial = new THREE.MeshStandardMaterial({
                    color: 0x00aaff,
                    emissive: 0x003366,
                    emissiveIntensity: 0.5,
                    transparent: true,
                    opacity: 0.7
                });
                
                for (let i = 0; i < 8; i++) {
                    const angle = (i / 8) * Math.PI * 2;
                    const window = new THREE.Mesh(windowGeometry, windowMaterial);
                    window.position.set(
                        Math.cos(angle) * 4.1,
                        3 + (i % 4) * 2.5,
                        Math.sin(angle) * 4.1
                    );
                    window.rotation.y = angle + Math.PI / 2;
                    mainModuleGroup.add(window);
                }
                
                // Ø§Ù„Ù…Ø¯Ø®Ù„ (Ø¨Ø§Ø¨ Ø¶ØºØ· Ù‡ÙˆØ§Ø¦ÙŠ)
                const doorGeometry = new THREE.BoxGeometry(2, 3, 0.5);
                const doorMaterial = new THREE.MeshStandardMaterial({
                    color: 0x222222,
                    metalness: 0.9
                });
                
                const door = new THREE.Mesh(doorGeometry, doorMaterial);
                door.position.set(0, 1.5, 4);
                mainModuleGroup.add(door);
                this.objects.mainDoor = door;
                
                // Ø¥Ø¶Ø§ÙØ© ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ø¨Ø§Ø¨
                this.interactives.push({
                    object: door,
                    type: 'door',
                    action: () => this.openMainDoor(),
                    distance: 3,
                    label: 'main_door'
                });
                
                // Ø§Ù„Ø£Ù„ÙˆØ§Ø­ Ø§Ù„Ø´Ù…Ø³ÙŠØ© (ÙˆØ§Ù‚Ø¹ÙŠØ© - 4 Ø£Ù„ÙˆØ§Ø­)
                for (let i = 0; i < 4; i++) {
                    this.createSolarPanel(-30 + i * 20, 8, -15);
                }
                
                // ÙˆØ­Ø¯Ø© Ø§Ù„Ù…Ø®ØªØ¨Ø± (Laboratory Module)
                this.createLabModule(15, 0, 20);
                
                // ÙˆØ­Ø¯Ø© Ø§Ù„Ø¯ÙÙŠØ¦Ø© (Greenhouse Module)
                this.createGreenhouseModule(-20, 0, 25);
                
                // Ù…Ø±ÙƒØ¨Ø© Ø§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù (Rover)
                this.createExplorationRover(25, 2, -10);
                
                // Ù‡ÙˆØ§Ø¦ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª (Communication Antenna)
                this.createCommunicationAntenna(-25, 0, -20);
                
                // Ù…Ù†ØµØ© Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„ØµÙˆØ§Ø±ÙŠØ® Ø§Ù„ØµØºÙŠØ±Ø©
                this.createLaunchPad(40, 0, 30);
                
                // Ù†Ø¸Ø§Ù… ØªØ®Ø²ÙŠÙ† Ø§Ù„ÙˆÙ‚ÙˆØ¯
                this.createFuelStorage(-35, 0, 35);
                
                mainModuleGroup.position.set(0, 0, 0);
                this.scene.add(mainModuleGroup);
                this.objects.mainModule = mainModuleGroup;
                
                // === Ø¢Ù„Ø© HYDROSHELL (ÙÙŠ Ù…Ø¨Ù†Ù‰ Ù…Ù†ÙØµÙ„) ===
                this.createHydroshellFacility(0, 0, -30);
                
                console.log('âœ… Ù…Ø­Ø·Ø© Artemis Ù…Ø¨Ù†ÙŠØ© - Ù…Ù‚Ø§ÙŠÙŠØ³ ÙˆØ§Ù‚Ø¹ÙŠØ©');
            }
            
            createSolarPanel(x, y, z) {
                const panelGroup = new THREE.Group();
                
                // Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©
                const base = new THREE.Mesh(
                    new THREE.CylinderGeometry(0.3, 0.3, 6, 8),
                    new THREE.MeshStandardMaterial({ color: 0x666666 })
                );
                base.position.set(0, 3, 0);
                panelGroup.add(base);
                
                // Ø§Ù„Ù…Ø­ÙˆØ±
                const axis = new THREE.Mesh(
                    new THREE.BoxGeometry(0.2, 0.2, 3),
                    new THREE.MeshStandardMaterial({ color: 0x888888 })
                );
                axis.position.set(0, 6, 0);
                panelGroup.add(axis);
                
                // Ø§Ù„Ù„ÙˆØ­ Ø§Ù„Ø´Ù…Ø³ÙŠ (Ø´ÙƒÙ„ ÙˆØ§Ù‚Ø¹ÙŠ)
                const panelGeometry = new THREE.BoxGeometry(8, 6, 0.1);
                const panelMaterial = new THREE.MeshStandardMaterial({
                    color: 0x111133,
                    metalness: 0.9,
                    roughness: 0.1,
                    emissive: 0x000033,
                    emissiveIntensity: 0.2
                });
                
                const panel = new THREE.Mesh(panelGeometry, panelMaterial);
                panel.position.set(4, 6, 0);
                panel.rotation.y = Math.PI / 2;
                panelGroup.add(panel);
                
                // Ø¥Ø·Ø§Ø± Ø§Ù„Ù„ÙˆØ­
                const frameGeometry = new THREE.BoxGeometry(8.2, 6.2, 0.15);
                const frameMaterial = new THREE.MeshStandardMaterial({ color: 0x333333 });
                const frame = new THREE.Mesh(frameGeometry, frameMaterial);
                frame.position.set(4, 6, 0);
                frame.rotation.y = Math.PI / 2;
                panelGroup.add(frame);
                
                panelGroup.position.set(x, y, z);
                panelGroup.rotation.y = Math.PI / 4;
                this.scene.add(panelGroup);
                
                // ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ø£Ù„ÙˆØ§Ø­ Ø§Ù„Ø´Ù…Ø³ÙŠØ©
                this.interactives.push({
                    object: panelGroup,
                    type: 'solar_panel',
                    action: () => this.inspectSolarPanel(),
                    distance: 5,
                    label: 'solar_panel'
                });
            }
            
            createLabModule(x, y, z) {
                const labGroup = new THREE.Group();
                

                // Ø§Ù„Ù…Ø¨Ù†Ù‰ (Ø´ÙƒÙ„ Ù…Ø³ØªØ·ÙŠÙ„ - Ù…Ø«Ù„ Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)
                const labGeometry = new THREE.BoxGeometry(10, 6, 8);
                const labMaterial = new THREE.MeshStandardMaterial({
                    color: 0x445577,
                    metalness: 0.6,
                    roughness: 0.3
                });
                
                const lab = new THREE.Mesh(labGeometry, labMaterial);
                lab.position.set(0, 3, 0);
                lab.castShadow = true;
                labGroup.add(lab);
                
                // Ø§Ù„Ù†ÙˆØ§ÙØ°
                const windowGeometry = new THREE.PlaneGeometry(1.5, 1);
                const windowMaterial = new THREE.MeshStandardMaterial({
                    color: 0x00ffff,
                    emissive: 0x004444,
                    emissiveIntensity: 0.3,
                    transparent: true,
                    opacity: 0.6
                });
                
                for (let i = 0; i < 3; i++) {
                    for (let j = 0; j < 2; j++) {
                        const window = new THREE.Mesh(windowGeometry, windowMaterial);
                        window.position.set(-3 + i * 3, 2 + j * 2, 4.1);
                        labGroup.add(window);
                    }
                }
                
                // Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø®Ø§Ø±Ø¬ÙŠØ©
                const controlPanel = new THREE.Mesh(
                    new THREE.BoxGeometry(3, 2, 0.2),
                    new THREE.MeshStandardMaterial({ color: 0x222222 })
                );
                controlPanel.position.set(0, 1.5, 4);
                labGroup.add(controlPanel);
                
                this.interactives.push({
                    object: controlPanel,
                    type: 'lab_panel',
                    action: () => this.accessLabControl(),
                    distance: 2,
                    label: 'lab_control'
                });
                
                labGroup.position.set(x, y, z);
                this.scene.add(labGroup);
                this.objects.labModule = labGroup;
            }
            
            createGreenhouseModule(x, y, z) {
                const greenhouseGroup = new THREE.Group();
                
                // Ø§Ù„Ù‡ÙŠÙƒÙ„ (Ø´ÙƒÙ„ Ù†ØµÙ ÙƒØ±ÙˆÙŠ - Ù…Ø«Ù„ Ø§Ù„Ø¨ÙŠÙˆØª Ø§Ù„Ù…Ø­Ù…ÙŠØ© Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ©)
                const domeGeometry = new THREE.SphereGeometry(6, 32, 32, 0, Math.PI * 2, 0, Math.PI / 2);
                const domeMaterial = new THREE.MeshStandardMaterial({
                    color: 0x88ff88,
                    transparent: true,
                    opacity: 0.7,
                    metalness: 0.1,
                    roughness: 0
                });
                
                const dome = new THREE.Mesh(domeGeometry, domeMaterial);
                dome.position.set(0, 0, 0);
                dome.rotation.x = Math.PI;
                greenhouseGroup.add(dome);
                
                // Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©
                const baseGeometry = new THREE.CylinderGeometry(6, 6, 0.5, 32);
                const baseMaterial = new THREE.MeshStandardMaterial({ color: 0x333333 });
                const base = new THREE.Mesh(baseGeometry, baseMaterial);
                base.position.set(0, 0.25, 0);
                greenhouseGroup.add(base);
                
                // Ø§Ù„Ù†Ø¨Ø§ØªØ§Øª (ØªÙ…Ø«ÙŠÙ„ÙŠØ©)
                for (let i = 0; i < 20; i++) {
                    const plantGeometry = new THREE.ConeGeometry(0.3, 1, 8);
                    const plantMaterial = new THREE.MeshStandardMaterial({ color: 0x00aa00 });
                    const plant = new THREE.Mesh(plantGeometry, plantMaterial);
                    
                    const angle = Math.random() * Math.PI * 2;
                    const radius = Math.random() * 5;
                    plant.position.set(
                        Math.cos(angle) * radius,
                        0.5,
                        Math.sin(angle) * radius
                    );
                    plant.scale.setScalar(0.5 + Math.random() * 0.5);
                    greenhouseGroup.add(plant);
                }
                
                greenhouseGroup.position.set(x, y, z);
                this.scene.add(greenhouseGroup);
                this.objects.greenhouse = greenhouseGroup;
                
                this.interactives.push({
                    object: greenhouseGroup,
                    type: 'greenhouse',
                    action: () => this.inspectGreenhouse(),
                    distance: 5,
                    label: 'greenhouse'
                });
            }
            
            createExplorationRover(x, y, z) {
                const roverGroup = new THREE.Group();
                
                // Ø§Ù„Ù‡ÙŠÙƒÙ„
                const bodyGeometry = new THREE.BoxGeometry(3, 1.2, 2);
                const bodyMaterial = new THREE.MeshStandardMaterial({
                    color: 0xff0000,
                    metalness: 0.7,
                    roughness: 0.3
                });
                const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
                body.position.set(0, 0.6, 0);
                roverGroup.add(body);
                
                // Ø§Ù„Ù…Ù‚ØµÙˆØ±Ø©
                const cabinGeometry = new THREE.BoxGeometry(2, 0.8, 1.8);
                const cabinMaterial = new THREE.MeshStandardMaterial({
                    color: 0x333333,
                    transparent: true,
                    opacity: 0.8
                });
                const cabin = new THREE.Mesh(cabinGeometry, cabinMaterial);
                cabin.position.set(0, 1.2, 0);
                roverGroup.add(cabin);
                
                // Ø§Ù„Ø¹Ø¬Ù„Ø§Øª (6 Ø¹Ø¬Ù„Ø§Øª - Ù…Ø«Ù„ Ù…Ø±ÙƒØ¨Ø§Øª Ù†Ø§Ø³Ø§)
                const wheelGeometry = new THREE.CylinderGeometry(0.4, 0.4, 0.3, 16);
                wheelGeometry.rotateZ(Math.PI / 2);
                const wheelMaterial = new THREE.MeshStandardMaterial({ color: 0x111111 });
                
                const wheelPositions = [
                    [-1.2, 0.4, -0.8], [1.2, 0.4, -0.8],
                    [-1.2, 0.4, 0], [1.2, 0.4, 0],
                    [-1.2, 0.4, 0.8], [1.2, 0.4, 0.8]
                ];
                
                wheelPositions.forEach(pos => {
                    const wheel = new THREE.Mesh(wheelGeometry, wheelMaterial);
                    wheel.position.set(pos[0], pos[1], pos[2]);
                    roverGroup.add(wheel);
                });
                
                // Ø§Ù„Ø°Ø±Ø§Ø¹ Ø§Ù„Ø¢Ù„ÙŠØ©
                const armGroup = new THREE.Group();
                const armBase = new THREE.Mesh(
                    new THREE.CylinderGeometry(0.2, 0.2, 0.8, 8),
                    new THREE.MeshStandardMaterial({ color: 0x666666 })
                );
                armBase.position.set(-1, 0.9, 0.8);
                armGroup.add(armBase);
                
                roverGroup.position.set(x, y, z);
                this.scene.add(roverGroup);
                this.objects.rover = roverGroup;
                
                this.interactives.push({
                    object: roverGroup,
                    type: 'rover',
                    action: () => this.inspectRover(),
                    distance: 3,
                    label: 'exploration_rover'
                });
            }
            
            createCommunicationAntenna(x, y, z) {
                const antennaGroup = new THREE.Group();
                
                // Ø§Ù„Ø¨Ø±Ø¬
                const towerGeometry = new THREE.CylinderGeometry(0.5, 0.5, 15, 8);
                const towerMaterial = new THREE.MeshStandardMaterial({ color: 0x666666 });
                const tower = new THREE.Mesh(towerGeometry, towerMaterial);
                tower.position.set(0, 7.5, 0);
                antennaGroup.add(tower);
                
                // Ø§Ù„Ø·Ø¨Ù‚
                const dishGeometry = new THREE.SphereGeometry(3, 16, 8, 0, Math.PI * 2, 0, Math.PI / 2);
                const dishMaterial = new THREE.MeshStandardMaterial({
                    color: 0x888888,
                    metalness: 0.9,
                    roughness: 0.1
                });
                const dish = new THREE.Mesh(dishGeometry, dishMaterial);
                dish.position.set(0, 15, 0);
                dish.rotation.x = Math.PI;
                antennaGroup.add(dish);
                
                antennaGroup.position.set(x, y, z);
                this.scene.add(antennaGroup);
                this.objects.antenna = antennaGroup;
                
                this.interactives.push({
                    object: antennaGroup,
                    type: 'antenna',
                    action: () => this.inspectAntenna(),
                    distance: 8,
                    label: 'communication_antenna'
                });
            }
            
            createLaunchPad(x, y, z) {
                const padGroup = new THREE.Group();
                
                // Ø§Ù„Ù…Ù†ØµØ©
                const padGeometry = new THREE.CylinderGeometry(8, 8, 2, 32);
                const padMaterial = new THREE.MeshStandardMaterial({ color: 0x333333 });
                const pad = new THREE.Mesh(padGeometry, padMaterial);
                pad.position.set(0, 1, 0);
                padGroup.add(pad);
                
                // Ø§Ù„ØµØ§Ø±ÙˆØ® Ø§Ù„ØµØºÙŠØ±
                const rocketGeometry = new THREE.ConeGeometry(1, 10, 32);
                const rocketMaterial = new THREE.MeshStandardMaterial({
                    color: 0xffffff,
                    metalness: 0.8
                });
                const rocket = new THREE.Mesh(rocketGeometry, rocketMaterial);
                rocket.position.set(0, 6, 0);
                padGroup.add(rocket);
                
                padGroup.position.set(x, y, z);
                this.scene.add(padGroup);
                this.objects.launchPad = padGroup;
            }
            
            createFuelStorage(x, y, z) {
                const storageGroup = new THREE.Group();
                
                // Ø®Ø²Ø§Ù† Ø§Ù„ÙˆÙ‚ÙˆØ¯
                const tankGeometry = new THREE.CylinderGeometry(3, 3, 10, 32);
                const tankMaterial = new THREE.MeshStandardMaterial({
                    color: 0x666666,
                    metalness: 0.9
                });
                const tank = new THREE.Mesh(tankGeometry, tankMaterial);
                tank.position.set(0, 5, 0);
                storageGroup.add(tank);
                
                // Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©
                const baseGeometry = new THREE.CylinderGeometry(3.5, 3.5, 1, 32);
                const baseMaterial = new THREE.MeshStandardMaterial({ color: 0x444444 });
                const base = new THREE.Mesh(baseGeometry, baseMaterial);
                base.position.set(0, 0.5, 0);
                storageGroup.add(base);
                
                storageGroup.position.set(x, y, z);
                this.scene.add(storageGroup);
                this.objects.fuelStorage = storageGroup;
            }
            

            // ========== Ù…Ù†Ø´Ø£Ø© HYDROSHELL Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ==========
            createHydroshellFacility(x, y, z) {
                const facilityGroup = new THREE.Group();
                
                // Ø§Ù„Ù…Ø¨Ù†Ù‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
                const buildingGeometry = new THREE.BoxGeometry(15, 8, 12);
                const buildingMaterial = new THREE.MeshStandardMaterial({
                    color: 0x0066cc,
                    metalness: 0.6,
                    roughness: 0.3
                });
                const building = new THREE.Mesh(buildingGeometry, buildingMaterial);
                building.position.set(0, 4, 0);
                building.castShadow = true;
                facilityGroup.add(building);
                
                // Ø§Ù„Ù…Ø¯Ø®Ù„
                const doorGeometry = new THREE.BoxGeometry(3, 4, 0.5);
                const doorMaterial = new THREE.MeshStandardMaterial({ color: 0x222222 });
                const door = new THREE.Mesh(doorGeometry, doorMaterial);
                door.position.set(0, 2, 6);
                facilityGroup.add(door);
                this.objects.hydroshellDoor = door;
                
                // Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯Ø®Ù„
                const controlPanel = new THREE.Mesh(
                    new THREE.BoxGeometry(2, 1.5, 0.1),
                    new THREE.MeshStandardMaterial({ color: 0x333333 })
                );
                controlPanel.position.set(0, 1.5, 6.5);
                facilityGroup.add(controlPanel);
                
                // Ø¹Ù„Ø§Ù…Ø© HYDROSHELL
                const signGeometry = new THREE.PlaneGeometry(8, 2);
                const signMaterial = new THREE.MeshStandardMaterial({
                    color: 0x00ff00,
                    emissive: 0x004400,
                    emissiveIntensity: 0.5,
                    side: THREE.DoubleSide
                });
                const sign = new THREE.Mesh(signGeometry, signMaterial);
                sign.position.set(0, 8, 6);
                sign.rotation.y = Math.PI;
                facilityGroup.add(sign);
                
                facilityGroup.position.set(x, y, z);
                this.scene.add(facilityGroup);
                this.objects.hydroshellFacility = facilityGroup;
                
                // ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                this.interactives.push({
                    object: controlPanel,
                    type: 'hydroshell_panel',
                    action: () => this.accessHydroshellMachine(),
                    distance: 2,
                    label: 'hydroshell_control'
                });
            }
            
            // ========== Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…Ù‡Ù…Ø© ==========
            setupMissionSystems() {
                // ÙƒØ´Ù Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª
                this.setupInteractionSystem();
                
                // ØªØ­Ø¯ÙŠØ« HUD
                this.setupHUDSystem();
                
                // Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆÙ‚Øª
                this.setupTimeSystem();
                
                console.log('âœ… Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…Ù‡Ù…Ø© Ø¬Ø§Ù‡Ø²Ø©');
            }
            
            setupInteractionSystem() {
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª ÙÙŠ ÙƒÙ„ Ø¥Ø·Ø§Ø±
                const checkInteractions = () => {
                    if (!this.missionStarted) return;
                    
                    const cameraPos = this.camera.position;
                    let closest = null;
                    let minDistance = Infinity;
                    
                    for (const interactive of this.interactives) {
                        const distance = cameraPos.distanceTo(interactive.object.position);
                        
                        if (distance < interactive.distance && distance < minDistance) {
                            closest = interactive;
                            minDistance = distance;
                        }
                    }
                    
                    this.currentInteractive = closest;
                    
                    // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù…ÙŠØ­ Ø§Ù„ØªÙØ§Ø¹Ù„
                    const hint = document.getElementById('interactionHint');
                    if (closest) {
                        hint.style.display = 'block';
                        
                        const t = this.translations[this.state.language];
                        let hintText = '';
                        
                        switch (closest.type) {
                            case 'door':
                                hintText = t.interactDoor;
                                break;
                            case 'hydroshell_panel':
                                hintText = t.interactMachine;
                                break;
                            case 'lab_panel':
                                hintText = t.interactPanel;
                                break;
                            case 'solar_panel':
                                hintText = t.interactPanel;
                                break;
                            default:
                                hintText = t.interactPanel;
                        }
                        
                        hint.textContent = hintText;
                    } else {
                        hint.style.display = 'none';
                    }
                };
                
                // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø­Ù„Ù‚Ø© Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©
                this.updateCallbacks.push(checkInteractions);
            }
            
            setupHUDSystem() {
                // ØªØ­Ø¯ÙŠØ« HUD ÙÙŠ ÙƒÙ„ Ø¥Ø·Ø§Ø±
                const updateHUD = () => {
                    if (!this.missionStarted) return;
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
                    this.state.missionTime += this.clock.getDelta();
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙˆÙƒØ³Ø¬ÙŠÙ† (ÙŠÙ†Ø®ÙØ¶ Ø¨Ø¨Ø·Ø¡)
                    this.state.oxygen = Math.max(0, this.state.oxygen - 0.0001);
                    
                    // ØªØ­Ø¯ÙŠØ« HUD
                    this.updateHUD();
                };
                
                this.updateCallbacks.push(updateHUD);
            }
            
            setupTimeSystem() {
                // Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‡Ø§Ø±/Ø§Ù„Ù„ÙŠÙ„ (ÙŠÙˆÙ… Ù‚Ù…Ø±ÙŠ = 29.5 ÙŠÙˆÙ… Ø£Ø±Ø¶ÙŠ)
                const updateDayNight = () => {
                    if (!this.scene) return;
                    
                    const time = Date.now() * 0.0001; // Ø¨Ø·ÙŠØ¡ Ø¬Ø¯Ø§Ù‹ Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù‚Ù…Ø±ÙŠ
                    const sun = this.scene.children.find(child => child.type === 'DirectionalLight');
                    
                    if (sun) {
                        sun.position.x = Math.cos(time) * 100;
                        sun.position.z = Math.sin(time) * 100;
                        sun.position.y = 50 + Math.sin(time * 0.5) * 30;
                    }
                };
                
                this.updateCallbacks.push(updateDayNight);
            }
            
            // ========== Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù…ÙØ§ØªÙŠØ­ ==========
            setupKeyControls() {
                document.addEventListener('keydown', (event) => {
                    if (!this.missionStarted) return;
                    
                    switch (event.code) {
                        case 'KeyW':
                        case 'ArrowUp':
                            this.moveForward = true;
                            break;
                        case 'KeyS':
                        case 'ArrowDown':
                            this.moveBackward = true;
                            break;
                        case 'KeyA':
                        case 'ArrowLeft':
                            this.moveLeft = true;
                            break;
                        case 'KeyD':
                        case 'ArrowRight':
                            this.moveRight = true;
                            break;
                        case 'Space':
                            if (this.canJump) {
                                this.velocity.y += this.jumpHeight;
                                this.canJump = false;
                            }
                            break;
                        case 'KeyE':
                            this.handleInteraction();
                            break;
                        case 'ShiftLeft':
                        case 'ShiftRight':
                            this.moveSpeed = 6.0; // Ø±ÙƒØ¶
                            break;
                    }
                });
                
                document.addEventListener('keyup', (event) => {
                    if (!this.missionStarted) return;
                    
                    switch (event.code) {
                        case 'KeyW':
                        case 'ArrowUp':
                            this.moveForward = false;
                            break;
                        case 'KeyS':
                        case 'ArrowDown':
                            this.moveBackward = false;
                            break;
                        case 'KeyA':
                        case 'ArrowLeft':
                            this.moveLeft = false;
                            break;
                        case 'KeyD':
                        case 'ArrowRight':
                            this.moveRight = false;
                            break;
                        case 'ShiftLeft':
                        case 'ShiftRight':
                            this.moveSpeed = 4.0; // Ø¹ÙˆØ¯Ø© Ù„Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
                            break;
                    }
                });
                
                // ØªÙØ¹ÙŠÙ„ PointerLock Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø±
                document.addEventListener('click', () => {
                    if (this.missionStarted && document.pointerLockElement !== document.body) {
                        document.body.requestPointerLock();
                    }
                });
            }
            

            // ========== Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª ==========
            handleInteraction() {
                if (this.currentInteractive && !this.isInteracting) {
                    this.isInteracting = true;
                    this.playSound('click');
                    
                    // ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡
                    this.currentInteractive.action();
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©
                    setTimeout(() => {
                        this.isInteracting = false;
                    }, 1000);
                }
            }
            
            openMainDoor() {
                this.playSound('doorSound');
                this.showNotification('Ø¨Ø§Ø¨ Ø§Ù„Ø¶ØºØ· Ø§Ù„Ù‡ÙˆØ§Ø¦ÙŠ Ù…ÙØªÙˆØ­', 'info');
                
                // ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø¨Ø§Ø¨
                if (this.objects.mainDoor) {
                    this.objects.mainDoor.rotation.y = Math.PI / 4;
                    
                    setTimeout(() => {
                        this.objects.mainDoor.rotation.y = 0;
                    }, 5000);
                }
            }
            
accessHydroshellMachine() {
    this.playSound('machineSound');
    this.showNotification('ØªØ´ØºÙŠÙ„ Ø¢Ù„Ø© HYDROSHELL - Ø¬Ø§Ø±ÙŠ ÙØªØ­ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ…...', 'info');
    
    // ÙØªØ­ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø£ØµÙ„ÙŠ ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©
    setTimeout(() => {
        this.openOriginalProject();
    }, 1000);
}

openOriginalProject() {
    // Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
    this.saveProgress();
    
    // Ø®ÙŠØ§Ø± 1: ÙØªØ­ ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø© (ÙŠÙØ¶Ù„)
    window.open('Project.html', '_blank', 'width=1400,height=800,location=yes,menubar=yes,toolbar=yes');
    
    // Ø®ÙŠØ§Ø± Ø¨Ø¯ÙŠÙ„: ÙØªØ­ ÙÙŠ iframe Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙØ­Ø©
    /*
    const iframe = document.createElement('iframe');
    iframe.src = 'Project.html';
    iframe.style.position = 'fixed';
    iframe.style.top = '0';
    iframe.style.left = '0';
    iframe.style.width = '100%';
    iframe.style.height = '100%';
    iframe.style.border = 'none';
    iframe.style.zIndex = '1000';
    iframe.style.backgroundColor = '#fff';
    
    // Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø©
    const backButton = document.createElement('button');
    backButton.innerHTML = this.state.language === 'ar' ? 'â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©' : 'â† Return to Simulation';
    backButton.style.position = 'fixed';
    backButton.style.top = '20px';
    backButton.style.left = '20px';
    backButton.style.zIndex = '1001';
    backButton.style.padding = '12px 20px';
    backButton.style.background = 'linear-gradient(45deg, #006080, #00a0cc)';
    backButton.style.color = 'white';
    backButton.style.border = 'none';
    backButton.style.borderRadius = '6px';
    backButton.style.cursor = 'pointer';
    backButton.style.fontFamily = "'Orbitron', sans-serif";
    backButton.style.fontSize = '1rem';
    backButton.style.boxShadow = '0 4px 15px rgba(0,0,0,0.3)';
    
    backButton.addEventListener('click', () => {
        document.body.removeChild(iframe);
        document.body.removeChild(backButton);
        
        this.showNotification('ØªÙ… Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø¨Ù„Ø§Ø·Ø© Ø¨Ù†Ø¬Ø§Ø­! Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø©', 'success');
        this.state.interactions++;
        this.updateHUD();
    });
    
    document.body.appendChild(iframe);
    document.body.appendChild(backButton);
    */
}
            // ========== Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª ==========
            setupAudio() {
                this.audio.bgMusic.volume = 0.2;
                this.audio.bgMusic.play().catch(() => {
                    this.audio.enabled = false;
                });
                
                this.audio.clickSound.volume = 0.4;
                this.audio.walkSound.volume = 0.1;
                this.audio.doorSound.volume = 0.5;
                this.audio.machineSound.volume = 0.6;
            }
            
            playSound(type) {
                if (!this.audio.enabled) return;
                
                try {
                    const sound = this.audio[`${type}Sound`];
                    if (sound) {
                        sound.currentTime = 0;
                        sound.play();
                    }
                } catch (e) {}
            }
            
            // ========== Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© ==========
            updateCallbacks = [];
            
            animate() {
                requestAnimationFrame(() => this.animate());
                
                const delta = this.clock.getDelta();
                
                if (this.missionStarted) {
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø±ÙƒØ©
                    this.updateMovement(delta);
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ù†Ø¸Ù…Ø©
                    this.updateCallbacks.forEach(callback => callback());
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
                    this.state.missionTime += delta;
                }
                
                // Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…
                this.renderer.render(this.scene, this.camera);
            }
            
updateMovement(delta) {
    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©
    this.velocity.y -= this.gravity * delta;
    
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø³Ù„Ø³Ø© Ù„Ù„Ø­Ø±ÙƒØ©
    const acceleration = 15.0; // ØªØ³Ø§Ø±Ø¹ Ø³Ù„Ø³
    const damping = 0.9; // ØªØ®Ù…ÙŠØ¯ Ù…Ø¹ØªØ¯Ù„
    
    // Ø­Ø³Ø§Ø¨ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø­Ø±ÙƒØ©
    let targetVelocityX = 0;
    let targetVelocityZ = 0;
    
    if (this.moveForward) targetVelocityZ -= this.moveSpeed;
    if (this.moveBackward) targetVelocityZ += this.moveSpeed;
    if (this.moveLeft) targetVelocityX -= this.moveSpeed;
    if (this.moveRight) targetVelocityX += this.moveSpeed;
    
    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ³Ø§Ø±Ø¹ Ø§Ù„Ø³Ù„Ø§Ø³Ø©
    this.velocity.x += (targetVelocityX - this.velocity.x) * acceleration * delta;
    this.velocity.z += (targetVelocityZ - this.velocity.z) * acceleration * delta;
    
    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ®Ù…ÙŠØ¯ Ù„Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø³Ù„Ø§Ø³Ø©
    this.velocity.x *= damping;
    this.velocity.z *= damping;
    
    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ø±ÙƒØ© Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
    this.controls.moveRight(this.velocity.x * delta);
    this.controls.moveForward(this.velocity.z * delta);
    
    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
    this.controls.getObject().position.y += this.velocity.y * delta;
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØµØ§Ø¯Ù… Ù…Ø¹ Ø§Ù„Ø£Ø±Ø¶
    if (this.controls.getObject().position.y < 10) {
        this.velocity.y = 0;
        this.controls.getObject().position.y = 10;
        this.canJump = true;
    }
    
    // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ù…Ø´ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø±ÙƒØ©
    if ((this.moveForward || this.moveBackward || this.moveLeft || this.moveRight) && this.canJump) {
        if (!this.isMoving) {
            this.isMoving = true;
            this.playSound('walk');
        }
    } else {
        this.isMoving = false;
    }
}
            // ========== ØªØ­Ø¯ÙŠØ« HUD ==========
            updateHUD() {
                if (!this.state.selectedCharacter) return;
                
                const t = this.translations[this.state.language];
                const char = this.state.selectedCharacter;
                
                document.getElementById('characterName').textContent = char.name[this.state.language];
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙŠÙ…
                document.getElementById('oxygenValue').textContent = Math.floor(this.state.oxygen);
                document.getElementById('pressureValue').textContent = this.state.pressure.toFixed(1);
                document.getElementById('tempValue').textContent = this.state.temperature.toFixed(1);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‡Ø¯Ù Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª
                if (this.state.interactions === 0) {
                    document.getElementById('objectiveText').textContent = t.exploreBase;
                } else if (this.state.interactions === 1) {
                    document.getElementById('objectiveText').textContent = t.findRecycling;
                } else if (this.state.interactions === 2) {
                    document.getElementById('objectiveText').textContent = t.operateMachine;
                } else {
                    document.getElementById('objectiveText').textContent = t.missionComplete;
                }
            }
            
            // ========== Ù†Ø¸Ø§Ù… Ø§Ù„Ù„ØºØ© ==========
            toggleLanguage() {
                this.state.language = this.state.language === 'ar' ? 'en' : 'ar';
                this.updateLanguage();
                this.updateUIText();
                this.updateHUD();
                
                document.body.dir = this.state.language === 'ar' ? 'rtl' : 'ltr';
            }
            
            updateLanguage() {
                document.getElementById('langBtn').textContent = this.translations[this.state.language].langBtn;
            }
            
            // ========== Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚Ø¯Ù… ==========
            saveProgress() {
                const progress = {
                    character: this.state.selectedCharacter?.id,
                    interactions: this.state.interactions,
                    missionTime: this.state.missionTime,
                    lastPlayed: new Date().toISOString()
                };
                
                localStorage.setItem('artemis_progress', JSON.stringify(progress));
            }
            
            loadProgress() {
                const saved = localStorage.getItem('artemis_progress');
                return saved ? JSON.parse(saved) : null;
            }
            
            // ========== Ø£Ø¯ÙˆØ§Øª Ù…Ø³Ø§Ø¹Ø¯Ø© ==========
            showNotification(message, type = 'info') {
                // ÙŠÙ…ÙƒÙ† ØªÙˆØ³ÙŠØ¹ Ù‡Ø°Ø§ Ù„Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¬Ù…ÙŠÙ„Ø©
                console.log(`[${type.toUpperCase()}] ${message}`);
                
                // Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø³ÙŠØ·
                const notification = document.createElement('div');
                notification.textContent = message;
                notification.style.position = 'fixed';
                notification.style.top = '50%';
                notification.style.left = '50%';
                notification.style.transform = 'translate(-50%, -50%)';
                notification.style.background = 'rgba(0, 20, 40, 0.9)';
                notification.style.color = type === 'success' ? '#00ff00' : '#00aaff';
                notification.style.padding = '15px 25px';
                notification.style.borderRadius = '8px';
                notification.style.border = `1px solid ${type === 'success' ? '#00ff00' : '#00aaff'}`;
                notification.style.zIndex = '1000';
                notification.style.fontFamily = "'Tajawal', sans-serif";
                notification.style.textAlign = 'center';
                notification.style.backdropFilter = 'blur(5px)';
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.opacity = '0';
                    notification.style.transition = 'opacity 0.5s';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 500);
                }, 3000);
            }
            
            showError(message) {
                alert(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…: ${message}`);
            }
            
            onWindowResize() {
                if (this.camera && this.renderer) {
                    this.camera.aspect = window.innerWidth / window.innerHeight;
                    this.camera.updateProjectionMatrix();
                    this.renderer.setSize(window.innerWidth, window.innerHeight);
                }
            }
        }
        
        // ========== Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ==========
        const mission = new ArtemisMission();
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => mission.initialize());
        } else {
            mission.initialize();
        }
        
        window.ArtemisMission = mission;
    </script>
</body>
</html>
